<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.324">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brandon Scott">
<meta name="dcterms.date" content="2025-09-07">

<title>The Bayesian Bandit - DJ RD: Using regression discontinuity to measure music personalization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The Bayesian Bandit</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://thebayesianbandit.com/sports_book/" rel="" target="">
 <span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/thebayesianbandit" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/brandon-scott-5a7139211/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">DJ RD: Using regression discontinuity to measure music personalization</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">operations</div>
                <div class="quarto-category">causal inference</div>
                <div class="quarto-category">python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brandon Scott </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 7, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#search-theory" id="toc-search-theory" class="nav-link" data-scroll-target="#search-theory">Search Theory</a></li>
  <li><a href="#testing-a-premium-product" id="toc-testing-a-premium-product" class="nav-link" data-scroll-target="#testing-a-premium-product">Testing a Premium Product</a></li>
  </ul></li>
  <li><a href="#regression-discontinuity-design-rdd" id="toc-regression-discontinuity-design-rdd" class="nav-link" data-scroll-target="#regression-discontinuity-design-rdd">Regression Discontinuity Design (RDD)</a>
  <ul class="collapse">
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a></li>
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model Specification</a></li>
  <li><a href="#model-results" id="toc-model-results" class="nav-link" data-scroll-target="#model-results">Model Results</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="abstract" class="level1">
<h1>Abstract</h1>
<p>A/B testing is the usual standard for understanding the effects of different treatments. A prominent use case is testing potential new product features. While A/B testing is great for clearly identifying the difference in important business metrics, it lacks the ability to purposely target specific customers. To accomodate for this change, companies can use quasi-experimental methods to extract a difference in experience measurement. In this post, we demonstrate regression discontinuity in the context of a music streaming company. Using this quasi-experimental method, we show that a company can offer an “exclusive” product experience while still holding the ability to extract causal effects.</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p><strong>PlayMe</strong>, a new US-based music streaming company, aims to differentiate itself from major competitors like Spotify and Apple Music. It plans to do this by offering state-of-the-art AI personalization. Leveraging the power of large language models (LLMs), PlayMe is building its music streaming experience around this technology. By immediately positioning itself as an AI streaming player, PlayMe intends to disrupt the music streaming industry.</p>
<p>Among its current features, PlayMe is preparing to release an <strong>AI DJ</strong>. Currently, the service offers two main options: a home page with personalized song recommendations and AI-curated playlists, and a search function for specific tracks. The new AI DJ feature is designed to simplify the user experience by eliminating the need for users to browse through different playlists or search for specific songs. The proposed addition is found in <a href="#fig-app-1">Figure&nbsp;2.1</a>.</p>
<div id="fig-app-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="playme_app.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.1: Current layout and Proposed Update</figcaption><p></p>
</figure>
</div>
<p>The AI DJ addition comes from current product analysis. Users who spend too much time searching for songs, in the search function or by skipping songs, end up having much shorter listening sessions than those who are consistently listening to music. <a href="#tbl-app-1">Table&nbsp;2.1</a> shows this relationship.</p>
<div id="tbl-app-1" class="anchored">
<table class="table">
<caption>Table&nbsp;2.1: PlayMe Product Analysis</caption>
<thead>
<tr class="header">
<th>avg time to first skip</th>
<th>avg session length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;2.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>&gt;2.0</td>
<td>15.0</td>
</tr>
</tbody>
</table>
</div>
<p>As we can see from <a href="#tbl-app-1">Table&nbsp;2.1</a>, users who take less than 2 minutes to take their first skip have an average session length of about 10 minutes. Compared to users who take more than 2 minutes to take their first skip, their average session length is 5 minutes longer.</p>
<p>The theory behind the AI DJ feature is simple: by providing a seamless flow of highly relevant songs, we can increase our users’ average session lengths. This, in turn, will enhance their overall experience and build stronger loyalty to the app.</p>
<section id="search-theory" class="level2">
<h2 class="anchored" data-anchor-id="search-theory">Search Theory</h2>
<p>The AI DJ and other PlayMe features are practical applications of search theory <span class="citation" data-cites="Stigler1961"><a href="#ref-Stigler1961" role="doc-biblioref">[1]</a></span>. From an economics standpoint, users are agents searching for “information” or “goods”—in this case, music. Search theory provides frameworks that help us reduce the friction, or cost, for our users to find what they want.</p>
<p>On PlayMe and other streaming services, it’s essential to maintain a large music library to ensure users have a wide range of choices. The primary challenge, then, is to design search features that minimize the time users spend trying to find their desired music.</p>
<p>When users begin a session on PlayMe, they are typically in one of two mindsets: focused search or exploratory search <span class="citation" data-cites="Li2019"><a href="#ref-Li2019" role="doc-biblioref">[2]</a></span>. To help those in the focused category, the search function allows them to find specific songs. For users in the exploratory group, the app generates curated playlists and song suggestions based on their listening history.</p>
<p>By lowering the cost of search, we gather more user data. This data then enhances our personalization algorithms and informs our overall product strategy. Furthermore, this process increases user loyalty by raising their <strong>switching costs</strong>. The more a user listens on PlayMe, the more the app learns their tastes, making it increasingly difficult for them to switch to a competitor and start their personalization journey over.</p>
</section>
<section id="testing-a-premium-product" class="level2">
<h2 class="anchored" data-anchor-id="testing-a-premium-product">Testing a Premium Product</h2>
<p>In most cases, a company would test a new product through some user tests done in-house and then a larger rollout through A/B testing. However, PlayMe doesn’t want to perform just a normal A/B test. They want this new feature to an “exclusive reward” for their most loyal and active customers.</p>
<p>PlayMe plans to offer the new AI DJ feature exclusively to users who average at least 30 minutes per session. This strategy serves a dual purpose. First, it rewards the app’s most active customers with early access. Second, it creates an exclusive “club” that may motivate other users to increase their session lengths in hopes of being included in future product tests.</p>
<p>In a standard A/B test, it’s fairly straightforward to measure the effects of distinct treatments since we have clear control and experimental groups. However, in this scenario, the product is rolled out exclusively to a group of users who already have high engagement metrics. The challenge, therefore, is to identify a suitable comparison group to ensure we can draw a valid inference about the success of the new AI DJ feature.</p>
</section>
</section>
<section id="regression-discontinuity-design-rdd" class="level1">
<h1>Regression Discontinuity Design (RDD)</h1>
<p>As previously discussed, how can we properly extract a causal estimate of our treatment while still offering an exclusive experience to our most avid users? One method is regression discontinuity <span class="citation" data-cites="Campbell1960"><a href="#ref-Campbell1960" role="doc-biblioref">[3]</a></span>. At a high level, the idea is simple: the difference between users just above and just below the treatment cutoff is marginal—in effect, it is nearly “random.” Therefore, regression discontinuity models the “jump” in outcomes between the treated group and those who just barely missed the cutoff.</p>
<p>From the information above, we know that only users who average at least 30 minutes per session get the treatment. Thus, users who were very close (e.g.&nbsp;29 minute average session) would be non-treated and would be part of our control group. From a purely experimental design perspective, our product rollout appears to meet the criteria to perform regression discontinuity. To further solidify this track, we can begin to explore the data.</p>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<p>We begin our EDA by modeling plotting the distribution of average session length in minutes (Note: This distribution only contains our more “active” listeners). This distribution is shown in <a href="#fig-eda-1">Figure&nbsp;3.1</a>.</p>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="cell-output cell-output-display">
<div id="fig-eda-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rdd_music_files/figure-html/fig-eda-1-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Top listener average session length distribution in minutes</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The distribution appears to be approximately normal and fairly centered around 30 minutes. This would imply that we are applying the treatment to those who are above average listeners in our core listener group. The next plot, <a href="#fig-eda-2">Figure&nbsp;3.2</a>, shows the count of those who received treatment (DJ) vs no treatment.</p>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="cell-output cell-output-display">
<div id="fig-eda-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rdd_music_files/figure-html/fig-eda-2-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: Barplot of count data for those untreated (0) and treated (1)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The barplot clearly indicates a fairly even split between treated vs untreated individuals. To illustrate if there is a jump in the data, we can view <a href="#fig-eda-3">Figure&nbsp;3.3</a>.</p>
<div class="cell" data-tags="[]" data-execution_count="6">
<div class="cell-output cell-output-display">
<div id="fig-eda-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rdd_music_files/figure-html/fig-eda-3-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.3: Scatterplot showing average session length by average time to first skip, split by treated and untreated</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can see a slight jump in the data at the 30 minute mark along the x axis. It appears that most of those who were treated have higher average time to skip than those who were untreated. However, we see that there are a few treated dots that follow the trend of the untreated.</p>
<p>In our scenario, this is a case of <strong>non-compliance</strong>. That is, even though some users qualified for the DJ, they chose not to use the DJ. We will have to account for this in our model later on.</p>
<p>To continue with the EDA, our data also includes primary device type of users. <a href="#fig-eda-4">Figure&nbsp;3.4</a> shows the distribution for each respective device.</p>
<div class="cell" data-tags="[]" data-execution_count="7">
<div class="cell-output cell-output-display">
<div id="fig-eda-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="rdd_music_files/figure-html/fig-eda-4-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.4: Distributions of average time to skip for phone users (top panel) and laptop users (bottom panel)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Both distributions appear to be bimodal (probably due to difference in treated vs untreated). Furthermore, the right peak on the phone distribution appears to have a higher mean than that of the laptop distritbution. There could be some interactive effect between having the DJ and the kind of device used. We can include this in our model specification.</p>
<p>Returning for a moment to the potential non-compliance issue, we can verify this by checking the proportion of users who used the DJ, given they were assigned the DJ.</p>
<div class="cell" data-tags="[]" data-execution_count="10">
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>use_dj
1    0.895582
0    0.104418
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<p>About 10% of users who were assigned the DJ did not use the DJ feature. This is a strong indicator of non-compliance which we should account for in our model.</p>
</section>
<section id="model-specification" class="level2">
<h2 class="anchored" data-anchor-id="model-specification">Model Specification</h2>
<p>The goal of our model is to extract a valid causal estimate of our DJ feature on average time to skip. To do this, we need to specify a model that accounts for: the discontinuity between treated and untreated and the non-compliance of some in the treated group. The first part is just utilizing a linear regression model. The second part means we need to adjust this regression model to be a <strong>two-stage least squares (2SLS)</strong> <span class="citation" data-cites="Theil1953"><a href="#ref-Theil1953" role="doc-biblioref">[4]</a></span> model.</p>
<p>A 2SLS model contains two parts: the first-stage regression and the second-stage regression (hence, two-stage). The first-stage model is found in <a href="#eq-2sls-1">Equation&nbsp;3.1</a>.</p>
<p><span id="eq-2sls-1"><span class="math display">\[
D_{i} = \gamma_{0} + \gamma_{1}X_{i} + \gamma_{2}T_{i} + \sum_{j=3}^{m}\gamma_{j}Z_{ji} + \epsilon_{i}
\tag{3.1}\]</span></span></p>
<p>The first-stage regression models the treatment status (1 for DJ, 0 for no DJ) for each individual <span class="math inline">\(i\)</span>. <span class="math inline">\(X_{i}\)</span> is our running variable (average session length) for each individual <span class="math inline">\(i\)</span>. <span class="math inline">\(T_{i}\)</span> is the instrument variable. We need the instrument variable to adjust for non-compliance since the treatment status is endogenous (i.e.&nbsp;correlated with the error term). To get an unbiased estimate, we use the instrument of assignment. That is, the treatment variable is a binary indicator of 1 if the user used the DJ and 0 otherwise. The instrument variable is a binary indicator of 1 if the user was assigned the DJ and 0 otherwise. The rest of the model are other covariates that help us to control for potential confounders (e.g.&nbsp;age, device type, etc.).</p>
<p>The second-stage of the 2SLS estimates our variable of interest. In this case, average time to first skip. The second-stage model is shown in <a href="#eq-2sls-2">Equation&nbsp;3.2</a>.</p>
<p><span id="eq-2sls-2"><span class="math display">\[
ln(Y_{i}) = \beta_{0} + \beta_{1}X_{i} + \beta_{2}\hat{D}_{i} + \sum_{j=3}^{m}\beta_{j}Z_{ji} + u_{i}
\tag{3.2}\]</span></span></p>
<p>In our model, we perform a log transformation to understand the percent change our treatment yields compared to the control group. The only real difference between <a href="#eq-2sls-1">Equation&nbsp;3.1</a> and <a href="#eq-2sls-2">Equation&nbsp;3.2</a> is <span class="math inline">\(\hat{D}\)</span>. This is the predicted treatment status from <a href="#eq-2sls-1">Equation&nbsp;3.1</a>. Using this model, we can calculate the <strong>local average treatment effect (LATE)</strong>, since we only want to measure the effect between those who complied with the treatment (i.e.&nbsp;those who actually used the DJ and were assigned it vs those who did not use the DJ and were not assigned it).</p>
</section>
<section id="model-results" class="level2">
<h2 class="anchored" data-anchor-id="model-results">Model Results</h2>
<p>The key parameter of interest is the treatment parameter, <code>use_dj</code>. Based on our EDA, we should expect a positive effect of DJ. Another parameter of interest would be the interaction term between <code>use_dj</code> and <code>device_laptop</code> to see if there is a difference of DJ effect by device type (Note: Mobile device is the baseline device in the model). Below is the output from our model.</p>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="13">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Parameter Estimates</caption>
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">Parameter</td>
<td data-quarto-table-cell-role="th">Std. Err.</td>
<td data-quarto-table-cell-role="th">T-stat</td>
<td data-quarto-table-cell-role="th">P-value</td>
<td data-quarto-table-cell-role="th">Lower CI</td>
<td data-quarto-table-cell-role="th">Upper CI</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>1.2795</td>
<td>0.0997</td>
<td>12.830</td>
<td>0.0000</td>
<td>1.0841</td>
<td>1.4750</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">avg_sess</td>
<td>0.0087</td>
<td>0.0025</td>
<td>3.5188</td>
<td>0.0004</td>
<td>0.0039</td>
<td>0.0136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">age</td>
<td>-0.0031</td>
<td>0.0030</td>
<td>-1.0469</td>
<td>0.2951</td>
<td>-0.0090</td>
<td>0.0027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gender_f</td>
<td>-0.0116</td>
<td>0.0129</td>
<td>-0.9007</td>
<td>0.3677</td>
<td>-0.0368</td>
<td>0.0136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">main_device_laptop</td>
<td>-0.2214</td>
<td>0.0206</td>
<td>-10.737</td>
<td>0.0000</td>
<td>-0.2618</td>
<td>-0.1810</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">use_term_device</td>
<td>-0.1514</td>
<td>0.0256</td>
<td>-5.9048</td>
<td>0.0000</td>
<td>-0.2016</td>
<td>-0.1011</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">use_dj</td>
<td>0.7834</td>
<td>0.0336</td>
<td>23.300</td>
<td>0.0000</td>
<td>0.7175</td>
<td>0.8493</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>At face value, the <code>use_dj</code> parameter shows a significant result. On average, users who used the AI DJ saw a log increase in average time to first skip of 0.7834. Additionally, those who used a laptop instead of a mobile device with the DJ saw a decrease in the DJ effect. That is, the DJ effect for laptop users was a log increase of ~0.63. To understand these values on a percentage scale, we can transform them by <span class="math inline">\((e^{X} - 1) * 100\)</span>. Below is the tranformation for <code>use_dj</code> for mobile and <code>use_dj</code> for laptop.</p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>use_dj: 118.9002474395752
use_term_device: 88.1520550200446</code></pre>
</div>
</div>
<p>According to our model, those who used the DJ saw a 118% increase in average time to first skip. That is a huge improvement! This effect represents the average percent increase in users who use mobile as their primary device (along with other covariates but won’t mention here). To calculate the effect of the treatment for laptop users, we combine the baseline effect with the interaction term in the transformation formula. This yields a 88% increase in average time to first skip for laptop users (still a great increase!).</p>
<p>While these estimates are exciting, we would want to verify that the model passes the standard assumptions for regression discontinuity. We won’t go into too much detail in this post on how to verify, but readers should be aware of key assumptions like continuity of the conditional mean, no manipulations of the running variable, etc.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The goal of this post was to demonstrate the usefulness of a quasi-experimental method in extracting causal inference while still providing exclusive experiences to customers who we believed deserved them. We planned a carefully designed study where those who listened on average over 30 minutes in a session would receive the treatment and those below the threshold would not. Using regression discontinuity and log-transforming the model, we found the causal estimate of the DJ program. Furthermore, since we had some who were “non-compliers” of DJ treatment assignment, we adjusted the model to account for this and estimated the LATE.</p>
<p>The next steps for PlayMe would be to form a strategy around these findings. Should PlayMe roll this out to all their customers? Keep it just for top listeners? PlayMe ideally would have had this in mind before performing the experiment, but no time like the present to plan on how to use their new tool. From the results, we recommend that PlayMe expand the DJ assignment to more users (perhaps those who average 20 minutes or more in a session). From here, PlayMe can continue to analyze data and run more experiments to understand if they should keep it as an exclusive or have it be a prominent feature for all their users.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Stigler1961" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">G. J. Stigler, <span>“The economics of information,”</span> <em>Journal of Political Economy</em>, vol. 69, no. 3, pp. 213–225, 1961, doi: <a href="https://doi.org/10.1086/258464">10.1086/258464</a>.</div>
</div>
<div id="ref-Li2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">A. Li, J. Thom, P. Chandar, C. Hosey, B. St. Thomas, and J. Garcia-Gathright, <span>“Search mindsets: Understanding focused and non-focused information seeking in music search,”</span> in <em>Proceedings of the web conference 2019 (WWW ’19)</em>, San Francisco, CA, USA: ACM, 2019, pp. 2210–2220. doi: <a href="https://doi.org/10.1145/3308558.3313627">10.1145/3308558.3313627</a>.</div>
</div>
<div id="ref-Campbell1960" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">D. T. Campbell and D. L. Thistlethwaite, <span>“Regression-discontinuity analysis: An alternative to the ex post facto experiment,”</span> <em>Journal of Educational Psychology</em>, vol. 51, no. 2, pp. 68–73, 1960, doi: <a href="https://doi.org/10.1037/h0044429">10.1037/h0044429</a>.</div>
</div>
<div id="ref-Theil1953" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">H. Theil, <span>“Repeated least-squares methods for finding the best linear regression equation,”</span> <em>Journal of the Royal Statistical Society, Series B (Methodological)</em>, vol. 15, no. 2, pp. 185–195, 1953.</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>